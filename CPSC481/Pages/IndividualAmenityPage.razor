@page "/individualamenitypage"
@using System.Threading;

<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="@firstSlideCss"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1" class="@secondSlideCss"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2" class="@thirdSlideCss"></li>
    </ol>
    <div class="title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-caret-left-fill" viewBox="0 0 16 16">
            <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z" />
        </svg>
        <h4>Name</h4>
    </div>
    <div class="carousel-inner">
        <div class="carousel-item @firstSlideCss">
            <img class="d-block w-100" src="https://live.staticflickr.com/3872/14485636510_20d3df5e6d_b.jpg" alt="First slide">
        </div>
        <div class="carousel-item @secondSlideCss">
            <img class="d-block w-100" src="https://www.globeguide.ca/wp-content/uploads/2014/08/Photo-e1408502843202.jpg" alt="Second slide">
        </div>
        <div class="carousel-item @thirdSlideCss">
            <img class="d-block w-100" src="https://images.dailyhive.com/20190710145740/Screen-Shot-2019-07-10-at-2.55.35-PM.png" alt="Third slide">
        </div>
    </div>
</div>

<div class="description">
    <p>This should be something</p>
    <p>Address</p>
    <p>Times</p>
</div>

<div class="tags">
    <span class="badge badge-pill badge-success">Animal</span>
    <span class="badge badge-pill badge-success">Outdoor</span>
    <span class="badge badge-pill badge-success">Hike</span>
    <span class="badge badge-pill badge-success">Nightlife</span>
    <span class="badge badge-pill badge-success">Monument</span>
    <span class="badge badge-pill badge-success">Light</span>
</div>

<div class="buttons">
    <div>
        <button type="button" class="btn btn-outline-success" id="bookmark">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
                <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z" />
            </svg>
        </button>
        <p>Bookmark</p>
    </div>
    <div>
        <button type="button" class="btn btn-outline-success" id="itinerary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
            </svg>
        </button>
        <p>Add to Itinerary</p>
    </div>
</div>

<h5>Similar Amenities</h5>

<div id="similar-amenities">
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
    <a href="/amenitysearch">
        <div class="card" style="width: 10rem;">
            <img class="card-img-top" src="https://i.pinimg.com/originals/90/17/0c/90170c4d3b53450e1555d65db2daac98.jpg" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
        </div>
    </a>
</div>

@code {
    string firstSlideCss = "active";
    string secondSlideCss = "";
    string thirdSlideCss = "";

    int currentPosition = 0;
    int currentSlide = 0;

    CancellationTokenSource cts;
    CancellationToken ct;

    protected override async Task OnInitializedAsync()
    {
        cts = new CancellationTokenSource();
        ct = cts.Token;
        await Walkthrough(ct);
    }

    public async Task Walkthrough(CancellationToken ct)
    {
        while (!ct.IsCancellationRequested)
        {
            await Task.Delay(2500, ct);
            currentPosition++;
            ChangeSlide();
            await InvokeAsync(() => this.StateHasChanged());
        }
    }

    public void Manually(bool backwards)
    {
        cts.Cancel();

        if (backwards)
            currentPosition--;
        else
            currentPosition++;

        ChangeSlide();
    }

    private void ChangeSlide()
    {
        currentSlide = Math.Abs(currentPosition % 3);

        switch (currentSlide)
        {
            case 0:
                firstSlideCss = "active";
                secondSlideCss = "";
                thirdSlideCss = "";
                break;
            case 1:
                firstSlideCss = "";
                secondSlideCss = "active";
                thirdSlideCss = "";
                break;
            case 2:
                firstSlideCss = "";
                secondSlideCss = "";
                thirdSlideCss = "active";
                break;
            default:
                break;
        }
    }
}
